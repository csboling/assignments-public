\documentclass{article}

\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{commath}
\usepackage{enumerate}

\usepackage{graphicx}

\title{ECE/ME 851 Homework \#8}
\date{November 12, 2014}
\author{Sam Boling \\ PID A48788119}

\begin{document}

\maketitle

\section*{Problem \#1}
Consider the transfer function
$$
H(s) = \frac{4s^2 + 27s + 41}{(s+2)(s+3)(s+5)}
$$

\begin{enumerate}
  \item{
    Expanding the denominator
    $$
    (s+2)(s+3)(s+5) = s^3 + 10s^2 + 31s + 30
    $$
    shows that the denominator has higher degree than the numerator
    and therefore this is a strictly proper rational function and
    therefore $H(\infty) = 0$. We then immediately have the controller
    form realization given by
    $$
    4s^2 + 27s + 41 = \beta_{1} s^2 + \beta_{1} s + \beta_{0}, \quad
    s^3 + 10s^2 + 31s + 30 = s^3 + \alpha_{2} s^2 + \alpha_{1} s + \alpha_0
    $$
    so that
    $$
    A_C =
    \left[\begin{array}{r r r}
       0         & 1           & 0          \\
       0         & 0           & 1          \\
      -\alpha_{0} & -\alpha_{1} & -\alpha_{2}
    \end{array}\right] =
    \left[\begin{array}{r r r}
       0  & 1   & 0   \\
       0  & 0   & 1   \\
      -30 & -31 & -10
    \end{array}\right], \quad
    B_C =
    \left[\begin{array}{r r r}
       0 \\
       0 \\
       1
    \end{array}\right], \quad
    C_c =
    \left[\begin{array}{r r r}
      \beta_{0} & \beta_{1} & \beta_{2}
    \end{array}\right] =
    \left[\begin{array}{r r r}
      41 & 27 & 4
    \end{array}\right], \quad
    D_C = H(\infty) = 0.
    $$
  }
  \item{
    Since the system is SISO, $H(s)^\top = H(s)$, so we obtain the
    observer-form realization
    $$
    A_O = A_C^\top =
    \left[\begin{array}{r r r}
      0 & 0 & -30 \\
      1 & 0 & -31 \\
      0 & 1 & -10
    \end{array}\right], \quad
    B_O = C_C^\top =
    \left[\begin{array}{c}
      41 \\
      27 \\
      4
    \end{array}\right], \quad
    C_O = B_C^\top =
    \left[\begin{array}{c c c}
      0 & 0 & 1
    \end{array}\right], \quad
    D_O = D_C^\top = 0.
    $$
  }
  \item{
    The matrix $A_C$ has distinct eigenvalues $-2, -3, -5$ and
    therefore can be diagonalized. We compute that this matrix has
    eigenvectors given by columns of the matrix
    $$
    P = \left[\begin{array}{r r r}
      1 &  1 &  1 \\
     -2 & -3 & -5 \\
      4 &  9 & 25
    \end{array}\right]
    $$
    so that under the similarity transformation we have
    $$
    \hat{A} = P^{-1} A_C P =
    \left[\begin{array}{r r r}
      -2 &  0 &  0 \\
       0 & -3 &  0 \\
       0 &  0 & -5
    \end{array}\right], \quad
    \hat{B} = P^{-1} B_C =
    \left[\begin{array}{r}
       \frac{1}{3} \\
      -\frac{1}{2} \\
       \frac{1}{6}
    \end{array}\right], \quad
    \hat{C} = C_C P =
    \left[\begin{array}{r r r}
      3 & -4 & 6
    \end{array}\right].
    $$
  }
\end{enumerate}

\pagebreak

\section*{Problem \#2}

\begin{enumerate}
\item{
  The equivalent sampled system is given by
  $$
  \bar{A} = e^{AT}, \quad
  \bar{B} = \left( \int_0^T e^{A \tau} \dif\tau \right) B.
  $$
  Therefore
  $$
  \bar{A} =
  \left[\begin{array}{r r}
    \cos T & \sin T \\
   -\sin T & \cos T
  \end{array}\right], \quad
  \bar{B} =
  \left[\begin{array}{c}
    \int_0^T \sin \tau \dif\tau
    \int_0^T \cos \tau \dif \tau
  \end{array}\right] =
  \left[\begin{array}{c}
    \left. -\cos \tau \right|_0^T \\
    \left. \sin \tau \right|_0^T
  \end{array}\right] =
  \left[\begin{array}{c}
    1 - \cos T \\
    \sin T
  \end{array}\right].
  $$
}
\item{
  For $T = \frac{\pi}{2}$, we have
  $$
  A =
  \left[\begin{array}{r r}
    0 &  1 \\
   -1 &  0
  \end{array}\right], \quad
  B =
  \left[\begin{array}{r}
    1 \\
    1
  \end{array}\right],
  $$
  so the controllability matrix and its inverse are given by
  $$
  \mathcal{C} =
  \left[\begin{array}{r r}
    1 &  1 \\
    1 & -1
  \end{array}\right], \quad
  \mathcal{C}^{-1} =
  \left[\begin{array}{r r}
    \frac{1}{2} &  \frac{1}{2} \\
    \frac{1}{2} & -\frac{1}{2}
  \end{array}\right] =
  $$
  Applying the Ackermann gain formula with the desired characteristic
  polynomial $\alpha_d(s) = s^2$ (to place both eigenvalues at zero)
  we have
  $$
  F = -e_2^\top \mathcal{C}^{-1} \alpha_d(A) =
  \left[\begin{array}{r r}
    \frac{1}{2} & -\frac{1}{2}
  \end{array}\right].
  $$

  The difference equation
  $$
  x(k+1) = A x(k) + B u(k)
  $$
  under linear state feedback control has the form
  $$
  x(k+1) = A x(k) + B F x(k) = (A + BF)x(k)
  $$
  which yields the response
  $$
  x(k) = (A + BF)^k x(0).
  $$
  With the feedback gains given above, we have
  $$
  A + BF =
  \left[\begin{array}{r r}
     \frac{1}{2} &  \frac{1}{2} \\
    -\frac{1}{2} & -\frac{1}{2}
  \end{array}\right]
  $$
  so that
  $
  (A + BF)^2 =
  \left[\begin{array}{c c}
    0 & 0 \\
    0 & 0
  \end{array}\right],
  $
  and therefore the system will converge in two time steps.
}
\item{
  From the system equation we have
  $$
  x(1) = A x(0) + B u(0)
  $$
  so using the matrices derived above we have
  $$
  \left[\begin{array}{c}
    x_1(1) \\
    x_2(1)
  \end{array}\right] =
  \left[\begin{array}{r}
     x_2(0) \\
    -x_1(0)
  \end{array}\right]
  +
  \left[\begin{array}{c}
    u(0) \\
    u(0)
  \end{array}\right].
  $$
  An input which steers the system to the origin in one timestep
  therefore requires
  $$
  u(0) = -x_2(0), \quad u(0) = x_1(0),
  $$
  or $x_1(0) = -x_2(0)$. Therefore only initial states which have the
  form
  $$
  x(0) =
  \left[\begin{array}{r}
    a \\
   -a
  \end{array}\right]
  $$
  can be steered to the origin in a single timestep, by applying the
  input $u(0) = a$.
}
\item{
  Assigning
  $
  C =
  \left[\begin{array}{c c}
    1 & 0
  \end{array}\right]
  $
  we can formulate the observer design as the dual controller design
  problem by letting
  $$
  \hat{A} = A^\top, \quad
  \hat{B} = C^\top, \quad
  \hat{F} = -K^\top.
  $$
  This yields
  $$
  \mathcal{C} =
  \left[\begin{array}{c c}
    1 & 0 \\
    0 & 1
  \end{array}\right]
  = \mathcal{C}^{-1}
  $$
  We find the gains for this system by
  $$
  \hat{F} = -e_2^\top \mathcal{C}^{-1} \alpha_d(A) =
  \left[\begin{array}{c c}
    0 & 1
  \end{array}\right]
  $$
  so that
  $
  K = -\hat{F}^\top =
  \left[\begin{array}{r}
    0 \\ -1
  \end{array}\right].
  $
  Then
  $$
  A - KC =
  \left[\begin{array}{c c}
    0 & 1 \\
    0 & 0
  \end{array}\right],
  $$
  so $(A - KC)^2 = \mathbf{0}_{2 \times 2}$. Therefore it will take 2
  steps for the state estimate to converge and another 2 for the
  observer-based controller to bring the system to the origin, for a
  total of 4 timesteps.
 }
\end{enumerate}

\pagebreak

\section*{Problem \#3}
For the transfer function $H(s) = \frac{s+1}{s^2 + 2}$, find
\begin{enumerate}
  \item{
    an uncontrollable realization
  }
  \item{
    an unobservable realization
  }\item{
    an uncontrollable and unobservable realization
  }\item{
    a minimal realization.
  }
\end{enumerate}

\pagebreak

\section*{Problem \#4}
Consider the transfer function
$$
H(s) =
\left[\begin{array}{c c}
  \frac{s-1}{s+1} & \frac{1}{s^2 - 1} \\
  1               & 0
\end{array}\right],
$$

so that the LCMs $d_i(s)$ of denominators of the $i$-th row are given
by
$$
d_1(s) = (s+1)(s-1) = s^2 - 1, \quad
d_2(s) = 1.
$$
and let
$$
\tilde{H}(s) = (H(s))^\top =
\left[\begin{array}{c c}
  \frac{s-1}{s+1}   & 1 \\
  \frac{1}{s^2 - 1} & 0
\end{array}\right] =
\left[\begin{array}{c c}
  \frac{s-1}{s+1}      & 1 \\
  \frac{1}{(s+1)(s-1)} & 0
\end{array}\right]
$$
so that
$$
\tilde{H}(\infty) =
\left[\begin{array}{c c}
  1 & 1 \\
  0 & 0
\end{array}\right].
$$
We then have
$d(s)$
$$
d_1(s) = (s+1)(s-1) = s^2 - 1, \quad
d_2(s) = 1
$$
so that
\begin{align*}
D(s) &=
\left[\begin{array}{c c}
  s^2-1 & 0 \\
  0     & 1
\end{array}\right]
=
\left[\begin{array}{c c}
  s^2 & 0 \\
  0   & 1
\end{array}\right]
+
\left[\begin{array}{r r}
  -1 & 0 \\
   0 & 0
\end{array}\right]
\\ &=
\left[\begin{array}{c c}
  s^2 & 0 \\
  0   & 1
\end{array}\right]
+
\left[\begin{array}{r r r}
  -1 & 0 & 0 \\
   0 & 0 & 0
\end{array}\right]
\left[\begin{array}{c c}
  1 & 0 \\
  s & 0 \\
  0 & 1
\end{array}\right],
\end{align*}
i.e. $
L =
\left[\begin{array}{r r r}
  -1 & 0 & 0 \\
   0 & 0 & 0
\end{array}\right].
$

Next we have
$$
N(s) = \tilde{H}(s)D(s) =
\left[\begin{array}{c c}
  (s-1)^2 & 1 \\
  1       & 0
\end{array}\right], \quad
\tilde{H}(\infty)D(s) =
\left[\begin{array}{c c}
  s^2 - 1 & 1 \\
  0       & 0
\end{array}\right]
$$
so
$$
N(s) - \tilde{H}(\infty)D(s) =
\left[\begin{array}{c c}
  -2s + 2 & 0 \\
   1      & 0
\end{array}\right]
=
\left[\begin{array}{r r r}
  -2 & 2 \\
   1 & 0
\end{array}\right]
\left[\begin{array}{c c}
  1   & 0 \\
  s   & 0
\end{array}\right],
$$
so that
$
M =
\left[\begin{array}{r r}
  -2 & 2 \\
   1 & 0
\end{array}\right].
$
We then have
$$
A_m =
\left[\begin{array}{c c c }
   0 & 1 \\
   0 & 0
\end{array}\right], \quad
B_m =
\left[\begin{array}{c c}
   0 & 0 \\
   1 & 0
\end{array}\right]
$$
so
\begin{align*}
A_C &= A_m - B_m L =
\left[\begin{array}{c c}
   0 & 1 \\
   1 & 0
\end{array}\right], \\
B_C &= B_m =
\left[\begin{array}{c c}
   0 & 0 \\
   1 & 0
\end{array}\right], \\\
C_C &= M =
\left[\begin{array}{r r}
  -2 & 2 \\
   1 & 0
\end{array}\right], \\\
D_C &= \hat{H}(\infty) =
\left[\begin{array}{c c}
   1 & 1 \\
   0 & 0
\end{array}\right]
\end{align*}

\end{document}
