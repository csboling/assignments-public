\documentclass{article}

\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{commath}
\usepackage{enumerate}

\usepackage{graphicx}

\title{ECE/ME 851 Homework \#7}
\date{November 5, 2014}
\author{Sam Boling \\ PID A48788119}

\begin{document}

\maketitle

\section*{Problem \#1}
Recall that the system given in Problem 9.4 is

$$
A =
\left[\begin{array}{r r r r}
  0 & 1 &  0 & 0 \\
  0 & 0 &  1 & 0 \\
  0 & 0 &  0 & 1 \\
  1 & 1 & -3 & 4
\end{array}\right], \quad
B =
\left[\begin{array}{r r}
  1 & 0 \\
  0 & 0 \\
  0 & 0 \\
  0 & 1
\end{array}\right].
$$

We first find the controllability matrix
$$
\mathcal{C} =
\left[\begin{array}{c c c c c c c c}
  1 & 0 & 0 & 0 & 0 &  0 &  0 &  1 \\
  0 & 0 & 0 & 0 & 0 &  1 &  1 &  4 \\
  0 & 0 & 0 & 1 & 1 &  4 &  4 & 13 \\
  0 & 1 & 1 & 4 & 4 & 13 & 13 & 41
\end{array}\right]
$$
which is spanned by
$$
\left\{
  \left[\begin{array}{c}
    1 \\ 0 \\ 0 \\ 0
  \end{array}\right] = b_1,
  \left[\begin{array}{c}
    0 \\ 0 \\ 0 \\ 1
  \end{array}\right] = b_2,
  \left[\begin{array}{c}
    0 \\ 0 \\ 1 \\ 4
  \end{array}\right] = Ab_2,
  \left[\begin{array}{c}
    0 \\ 1 \\ 4 \\ 13
  \end{array}\right] = A^2b_2
\right\}
$$
so the controllability indices are $\mu_1 = 1$, $\mu_2 = 3$ and
furthermore
$$
\bar{\mathcal{C}} =
  \left[\begin{array}{c c c c}
    1 & 0 & 0 &  0 \\
    0 & 0 & 0 &  1 \\
    0 & 0 & 1 &  4 \\
    0 & 1 & 4 & 13
  \end{array}\right], \quad
\bar{\mathcal{C}}^{-1} =
  \left[\begin{array}{r r r r}
    1 &  0 &  0 &  0 \\
    0 &  3 & -4 &  1 \\
    0 & -4 &  1 &  0 \\
    0 &  1 &  0 &  0
  \end{array}\right].
$$

We can then find a basis for the null space of
$\left[\begin{array}{c c}
  sI - A & B
\end{array}\right]$ by computing
$$
\left[\begin{array}{c}
   P^{-1} S(s) \\
  -D(s)
\end{array}\right] =
\left[\begin{array}{c}
   S(s) \\
  -B_m^{-1}[\Lambda(s) - A_m S(s)]
\end{array}\right]
$$
since $A$,$B$ is already in controller form.
where
$$
S(s) =
  \left[\begin{array}{c c}
    1 & 0 \\
    0 & 1 \\
    0 & s \\
    0 & s^2
  \end{array}\right],
$$
$$
\Lambda(s) =
  \left[\begin{array}{c c}
    s & 0   \\
    0 & s^3
  \end{array}\right],
$$
$$
A_m =
\left[\begin{array}{c}
  q_1 A^{\mu_1} \\
  \vdots      \\
  q_m A^{\mu_m}
\end{array}\right]
=
\left[\begin{array}{c c c c}
  0 & 1 &  0 & 0 \\
  1 & 1 & -3 & 4
\end{array}\right],
$$
and
$$
B_m =
\left[\begin{array}{c}
  q_1 A^{\mu_1 - 1} \\
  \vdots         \\
  q_m A^{\mu_m - 1}
\end{array}\right] B =
  \left[\begin{array}{c c}
    1 &  0 \\
    0 &  1
  \end{array}\right].
$$
Then
$$
D(s) =
B_m^{-1} [\Lambda(s) - A_m S(s)] =
  \left[\begin{array}{c c}
     s & -1 \\
    -1 & s^3 - 4s^2 + 3s - 1
  \end{array}\right]
$$
so
$$
\left[\begin{array}{r}
   P^{-1} S(s) \\
  -D(s)
\end{array}\right] =
\left[\begin{array}{r r}
  1 &  0 \\
  0 &  1 \\
  0 &  s \\
 -s &  1 \\
 -1 &  s^3 -  4s^2 + 3s - 1
\end{array}\right]
$$
is a basis for the null space of
$
\left[\begin{array}{c c}
  sI - A & B
\end{array}\right].
$

Taking
$$
s_1 = -1 + i, \quad
s_2 = -1 - i, \quad
s_3 = -2 + i, \quad
s_4 = -2 - i,
$$
we wish to place eigenvectors of the system such that the
eigenvectors corresponding to $-1 \pm i$ have no component
contributing to $x_1$. We can for instance choose eigenvectors
$$
V =
\left[\begin{array}{c c c c}
     0 &    0 &    1 &     1 \\
     1 &    1 &    1 &     1 \\
  -1+i & -1-i & -2+i &  -2-i \\
   -2i &   2i & 3-4i &  3+4i
\end{array}\right]
$$
corresponding to
$$
a_1 =
\left[\begin{array}{c}
  0 \\ 1
\end{array}\right], \quad
a_2 =
\left[\begin{array}{c}
  0 \\ 1
\end{array}\right], \quad
a_3 =
\left[\begin{array}{c}
  1 \\ 1
\end{array}\right],
a_4 =
\left[\begin{array}{c}
  1 \\ 1
\end{array}\right]
$$
so that $FV = W$
or
$$
F
\left[\begin{array}{c c c c}
     0 &    0 &     1 &    0 \\
     1 &    1 &     1 &    1 \\
  -1+i & -1-i &  -2+i & -2-i \\
   -2i &   2i &  3-4i & 3+4i
\end{array}\right]
=
\left[\begin{array}{c c c c}
        -1 &       -1 &   -3 + i &    -3 - i \\
  -2 + 13i & -2 - 13i & -22 +30i & -22 - 30i
\end{array}\right]
$$
so that
$$
F = WV^{-1} =
\left[\begin{array}{c c c c}
  -\frac{3}{2} & -2 & -1 & -\frac{1}{2} \\
   \frac{3}{2} & -6 & -4 & -\frac{17}{2}
\end{array}\right].
$$
We confirm that the matrix $A + BF$ has eigenvalues
$-1 \pm i$, $-2 \pm i$ and that the modes of $-1 \pm i$ do not appear
in $e^{(A + BF)t}$.

\section*{Problem \#2}

The system is given by
$$
A =
\left[\begin{array}{c c}
  0 & 1 \\
  1 & 1
\end{array}\right], \quad
B =
\left[\begin{array}{c c}
  1 \\
  0
\end{array}\right],
$$
and we wish to optimize the control for the performance indices
$$
J_1 = \int_0^\infty (x_1^2 + x_2^2 + u^2) \dif t, \quad
J_2 = \int_0^\infty (900(x_1^2 + x_2^2) + u^2) \dif t.
$$

For $J_1$ we have $Q = I_2$, $R = 1$, and $z = x$ so that
$M = I$. In this case we have $A^{\top} = A$ and so
the algebraic Ricatti equation is
\begin{align*}
   & A^\top P + P A - P B R^{-1} B^\top P + M Q M \\
 = & A P + P A - P B B^\top P + I \\
 = &
\left[\begin{array}{c c}
0 & 1 \\
1 & 1
\end{array}\right]
\left[\begin{array}{c c}
P_{11} & P_{12} \\
P_{12} & P_{22}
\end{array}\right]
+
\left[\begin{array}{c c}
P_{11} & P_{12} \\
P_{12} & P_{22}
\end{array}\right]
\left[\begin{array}{c c}
0 & 1 \\
1 & 1
\end{array}\right]
-
\left[\begin{array}{c c}
P_{11} & P_{12} \\
P_{12} & P_{22}
\end{array}\right]
\left[\begin{array}{c c}
1 & 0 \\
0 & 0
\end{array}\right]
\left[\begin{array}{c c}
P_{11} & P_{12} \\
P_{12} & P_{22}
\end{array}\right]
+
I = 0
\end{align*}
so we have the system of equations
\begin{align*}
  - P_{11}^2 + 2 P_{12} + 1 &= 0, \\
    P_{11}   +   P_{12} + P_{22} - P_{11} P_{12} &= 0, \\
  - P_{12}^2 + 2 P_{12} + 2 P_{22} + 1 &= 0.
\end{align*}
Then
\begin{align*}
P_{11} &= \sqrt{2 P_{12} + 1}, \\
P_{22} &= \frac{1}{2} (P_{12}^2 - 2 P_{12} - 1)
       = \frac{1}{2} (P_{12} - (1 + \sqrt{2}))(P_{12} - (1 - \sqrt{2}))
\end{align*}
which yields
$$
\sqrt{2 P_{12} + 1}
+ P_{12}
+ \frac{1}{2}(P_{12}^2 - 2P_{12} - 1)
- P_{12} \sqrt{2 P_{12} + 1} = 0
$$
or after simplification
$$
P_{12}^2 - 6P_{12} - 3 = 0
$$
so that $P_{12} = 3 \pm 2 \sqrt{3}$. But if
$P_{12} = 3 - 2\sqrt{3}$ then the positive-definite condition
$\det P = P_{11} P_{22} - P_{12}^2 > 0$ is not satisfied, so it must
be that $P_{12} = 3 + 2 \sqrt{3}$. Then
$$
P_{11} = \sqrt{7 + 4\sqrt{3}}, \quad
P_{12} = 3 + 2\sqrt{3}, \quad
P_{22} = 7 + 4\sqrt{3}.
$$
This yields the optimal input
$$
u(t)
 = -R^{-1} B^\top P x(t)
 = -\left[\begin{array}{c}
      \sqrt{7 + 4\sqrt{3}} \\
      3 + 2 \sqrt{3}
    \end{array}\right] x(t)
 \approx
   -\left[\begin{array}{c}
       3.7321 \\
       6.4641
    \end{array}\right] x(t).
$$
for performance index $J_1$.

For performance index $J_2$ we instead have
$M = \left[\begin{array}{c c}
       30 &  0 \\
       0  & 30
     \end{array}\right]$
and all other variables the same. Solving the algebraic Ricatti
equation in this case yields
$$
P \approx
  \left[\begin{array}{c c}
    32.431 & 75.869 \\
    75.869 & 2352.2
  \end{array}\right]
$$
and so
$$
u(t)
 = -R^{-1} B^\top P x(t)
 \approx
   -\left[\begin{array}{c}
        32.4 \\
      2352.2
    \end{array}\right] x(t).
$$

Using the starting condition
$x(0) = \left[\begin{array}{c}
          1 \\ 1
        \end{array}\right]$, the trajectories for each controller are
plotted in the attached figure. $J_2$ converges faster and
with similar overshoot, but the gain that must be applied for this
result is much larger.

\section*{Problem \#3}
For this system we have
$$
A
= \left[\begin{array}{r r}
    0 &  1 \\
    2 & -1
  \end{array}\right], \quad
B
= \left[\begin{array}{c}
    0 \\
    1
  \end{array}\right]
$$
and the performance index
$$
J = \int_0^\infty
      \left(
        x_1^2(t) + \frac{1}{2} x_2^2(t) + \frac{1}{4}u^2(t)
      \right) \dif t,
$$
so that
$$
R = \frac{1}{4}, \quad\
M = \left[\begin{array}{c c}
      1 & 0 \\
      0 & 1
    \end{array}\right]
Q = \left[\begin{array}{c c}
      1 & 0 \\
      0 & \frac{1}{2}
    \end{array}\right].
$$

\begin{enumerate}[(a)]
  \item{
    The algebraic Ricatti equation gives
    \begin{align*}
      & A^\top P + P A - P B R^{-1} B^\top P + M^\top Q M \\
    = & \left[\begin{array}{c c}
          -4 P_{12}^2 + 4 P_{12} + 1
        &    P_{11}   -   P_{12} + 2 P_{22} - 4 P_{12} P_{22} \\
             P_{11}   -   P_{12} + 2 P_{22} - 4 P_{12} P_{22}
        & -4 P_{22}^2 - 2 P_{22} + 2 P_{12} + \frac{1}{2}
        \end{array}\right] = 0.
    \end{align*}
    The positive definite solution of this system of equations is
    $$
    P \approx
    \left[\begin{array}{r r}
      1.1265 &  2.0379 \\
      2.0379 &  6.0183
    \end{array}\right]
    $$
    so the optimal control gain is
    $$
    K = -R^{-1} P
    = \left[\begin{array}{r r}
        -19.7636 & 6.9444 \\
          6.9444 & 2.9860
      \end{array}\right].
    $$
  }
  \item{
  }
\end{enumerate}



\end{document}
